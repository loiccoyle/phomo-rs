import{s as q}from"./workerHelpers-BsJqGT46.js";let i;const m=new Array(128).fill(void 0);m.push(void 0,null,!0,!1);function o(e){return m[e]}let T=m.length;function u(e){T===m.length&&m.push(m.length+1);const t=T;return T=m[t],m[t]=e,t}function W(e,t){try{return e.apply(this,t)}catch(n){i.__wbindgen_export_0(u(n))}}const B=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&B.decode();let I=null;function x(){return(I===null||I.buffer!==i.memory.buffer)&&(I=new Uint8Array(i.memory.buffer)),I}function p(e,t){return e=e>>>0,B.decode(x().slice(e,e+t))}function G(e){e<132||(m[e]=T,T=e)}function d(e){const t=o(e);return G(e),t}let h=0;const R=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},P=function(e,t){const n=R.encode(e);return t.set(n),{read:e.length,written:n.length}};function O(e,t,n){if(n===void 0){const b=R.encode(e),f=t(b.length,1)>>>0;return x().subarray(f,f+b.length).set(b),h=b.length,f}let r=e.length,_=t(r,1)>>>0;const a=x();let c=0;for(;c<r;c++){const b=e.charCodeAt(c);if(b>127)break;a[_+c]=b}if(c!==r){c!==0&&(e=e.slice(c)),_=n(_,r,r=c+e.length*3,1)>>>0;const b=x().subarray(_+c,_+r),f=P(e,b);c+=f.written,_=n(_,r,c,1)>>>0}return h=c,_}let A=null;function s(){return(A===null||A.buffer!==i.memory.buffer)&&(A=new DataView(i.memory.buffer)),A}function y(e){return e==null}function S(e){const t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){const _=e.description;return _==null?"Symbol":`Symbol(${_})`}if(t=="function"){const _=e.name;return typeof _=="string"&&_.length>0?`Function(${_})`:"Function"}if(Array.isArray(e)){const _=e.length;let a="[";_>0&&(a+=S(e[0]));for(let c=1;c<_;c++)a+=", "+S(e[c]);return a+="]",a}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(n&&n.length>1)r=n[1];else return toString.call(e);if(r=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:r}function Q(){i.init_panic_hook()}function E(e,t){const n=t(e.length*1,1)>>>0;return x().set(e,n/1),h=e.length,n}function Y(e,t,n){let r,_;try{const l=i.__wbindgen_add_to_stack_pointer(-16),j=E(e,i.__wbindgen_export_3),v=h;i.overlayGrid(l,j,v,t,n);var a=s().getInt32(l+4*0,!0),c=s().getInt32(l+4*1,!0),b=s().getInt32(l+4*2,!0),f=s().getInt32(l+4*3,!0),g=a,w=c;if(f)throw g=0,w=0,d(b);return r=g,_=w,p(g,w)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_export_1(r,_,1)}}let k=null;function V(){return(k===null||k.buffer!==i.memory.buffer)&&(k=new Uint32Array(i.memory.buffer)),k}function H(e,t){const n=t(e.length*4,4)>>>0;return V().set(e,n/4),h=e.length,n}function J(e,t){e=e>>>0;const n=s(),r=[];for(let _=e;_<e+4*t;_+=4)r.push(d(n.getUint32(_,!0)));return r}function Z(e){const t=i.initThreadPool(e);return d(t)}function tt(e){i.wbg_rayon_start_worker(e)}const et=Object.freeze({Cs420:0,0:"Cs420",Cs422:1,1:"Cs422",Cs444:2,2:"Cs444",Cs400:3,3:"Cs400"}),nt=Object.freeze({NormL1:0,0:"NormL1",NormL2:1,1:"NormL2",LuminanceL1:2,2:"LuminanceL1",LuminanceL2:3,3:"LuminanceL2",AvgColor:4,4:"AvgColor"}),rt=Object.freeze({Crop:0,0:"Crop",Resize:1,1:"Resize"}),_t=Object.freeze({Greedy:0,0:"Greedy",Hungarian:1,1:"Hungarian",Auction:2,2:"Auction"}),M=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>i.__wbg_mosaic_free(e>>>0,1));class it{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,M.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_mosaic_free(t,0)}constructor(t,n,r,_,a,c,b){try{const v=i.__wbindgen_add_to_stack_pointer(-16),D=E(t,i.__wbindgen_export_3),$=h;var f=y(b)?0:H(b,i.__wbindgen_export_3),g=h;i.mosaic_new(v,D,$,u(n),r,_,a,y(c)?2:c,f,g);var w=s().getInt32(v+4*0,!0),l=s().getInt32(v+4*1,!0),j=s().getInt32(v+4*2,!0);if(j)throw d(l);return this.__wbg_ptr=w>>>0,M.register(this,this.__wbg_ptr,this),this}finally{i.__wbindgen_add_to_stack_pointer(16)}}equalize(){i.mosaic_equalize(this.__wbg_ptr)}transferMasterToTiles(){i.mosaic_transferMasterToTiles(this.__wbg_ptr)}transferTilesToMaster(){try{const r=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_transferTilesToMaster(r,this.__wbg_ptr);var t=s().getInt32(r+4*0,!0),n=s().getInt32(r+4*1,!0);if(n)throw d(t)}finally{i.__wbindgen_add_to_stack_pointer(16)}}build(t){let n,r;try{const w=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_build(w,this.__wbg_ptr,t);var _=s().getInt32(w+4*0,!0),a=s().getInt32(w+4*1,!0),c=s().getInt32(w+4*2,!0),b=s().getInt32(w+4*3,!0),f=_,g=a;if(b)throw f=0,g=0,d(c);return n=f,r=g,p(f,g)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_export_1(n,r,1)}}buildWithSolver(t,n){let r,_;try{const l=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_buildWithSolver(l,this.__wbg_ptr,t,n);var a=s().getInt32(l+4*0,!0),c=s().getInt32(l+4*1,!0),b=s().getInt32(l+4*2,!0),f=s().getInt32(l+4*3,!0),g=a,w=c;if(f)throw g=0,w=0,d(b);return r=g,_=w,p(g,w)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_export_1(r,_,1)}}getTiles(){try{const c=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_getTiles(c,this.__wbg_ptr);var t=s().getInt32(c+4*0,!0),n=s().getInt32(c+4*1,!0),r=s().getInt32(c+4*2,!0),_=s().getInt32(c+4*3,!0);if(_)throw d(r);var a=J(t,n).slice();return i.__wbindgen_export_1(t,n*4,4),a}finally{i.__wbindgen_add_to_stack_pointer(16)}}getMaster(){let t,n;try{const g=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_getMaster(g,this.__wbg_ptr);var r=s().getInt32(g+4*0,!0),_=s().getInt32(g+4*1,!0),a=s().getInt32(g+4*2,!0),c=s().getInt32(g+4*3,!0),b=r,f=_;if(c)throw b=0,f=0,d(a);return t=b,n=f,p(b,f)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_export_1(t,n,1)}}buildBlueprint(t){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_buildBlueprint(a,this.__wbg_ptr,t);var n=s().getInt32(a+4*0,!0),r=s().getInt32(a+4*1,!0),_=s().getInt32(a+4*2,!0);if(_)throw d(r);return d(n)}finally{i.__wbindgen_add_to_stack_pointer(16)}}buildBlueprintWithSolver(t,n){try{const c=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_buildBlueprintWithSolver(c,this.__wbg_ptr,t,n);var r=s().getInt32(c+4*0,!0),_=s().getInt32(c+4*1,!0),a=s().getInt32(c+4*2,!0);if(a)throw d(_);return d(r)}finally{i.__wbindgen_add_to_stack_pointer(16)}}renderBlueprint(t){let n,r;try{const w=i.__wbindgen_add_to_stack_pointer(-16);i.mosaic_renderBlueprint(w,this.__wbg_ptr,u(t));var _=s().getInt32(w+4*0,!0),a=s().getInt32(w+4*1,!0),c=s().getInt32(w+4*2,!0),b=s().getInt32(w+4*3,!0),f=_,g=a;if(b)throw f=0,g=0,d(c);return n=f,r=g,p(f,g)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_export_1(n,r,1)}}}const C=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>i.__wbg_wbg_rayon_poolbuilder_free(e>>>0,1));class L{static __wrap(t){t=t>>>0;const n=Object.create(L.prototype);return n.__wbg_ptr=t,C.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,C.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_wbg_rayon_poolbuilder_free(t,0)}numThreads(){return i.wbg_rayon_poolbuilder_numThreads(this.__wbg_ptr)>>>0}receiver(){return i.wbg_rayon_poolbuilder_receiver(this.__wbg_ptr)>>>0}build(){i.wbg_rayon_poolbuilder_build(this.__wbg_ptr)}}async function X(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function F(){const e={};return e.wbg={},e.wbg.__wbg_buffer_609cc3eee51ed158=function(t){const n=o(t).buffer;return u(n)},e.wbg.__wbg_call_672a4d21634d4a24=function(){return W(function(t,n){const r=o(t).call(o(n));return u(r)},arguments)},e.wbg.__wbg_debug_e17b51583ca6a632=function(t,n,r,_){console.debug(o(t),o(n),o(r),o(_))},e.wbg.__wbg_done_769e5ede4b31c67b=function(t){return o(t).done},e.wbg.__wbg_error_524f506f44df1645=function(t){console.error(o(t))},e.wbg.__wbg_error_7534b8e9a36f1ab4=function(t,n){let r,_;try{r=t,_=n,console.error(p(t,n))}finally{i.__wbindgen_export_1(r,_,1)}},e.wbg.__wbg_error_80de38b3f7cc3c3c=function(t,n,r,_){console.error(o(t),o(n),o(r),o(_))},e.wbg.__wbg_get_67b2ba62fc30de12=function(){return W(function(t,n){const r=Reflect.get(o(t),o(n));return u(r)},arguments)},e.wbg.__wbg_get_b9b93047fe3cf45b=function(t,n){const r=o(t)[n>>>0];return u(r)},e.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(t,n){const r=o(t)[o(n)];return u(r)},e.wbg.__wbg_info_033d8b8a0838f1d3=function(t,n,r,_){console.info(o(t),o(n),o(r),o(_))},e.wbg.__wbg_instanceof_ArrayBuffer_e14585432e3737fc=function(t){let n;try{n=o(t)instanceof ArrayBuffer}catch{n=!1}return n},e.wbg.__wbg_instanceof_Uint8Array_17156bcf118086a9=function(t){let n;try{n=o(t)instanceof Uint8Array}catch{n=!1}return n},e.wbg.__wbg_instanceof_Window_def73ea0955fc569=function(t){let n;try{n=o(t)instanceof Window}catch{n=!1}return n},e.wbg.__wbg_isArray_a1eab7e0d067391b=function(t){return Array.isArray(o(t))},e.wbg.__wbg_isSafeInteger_343e2beeeece1bb0=function(t){return Number.isSafeInteger(o(t))},e.wbg.__wbg_iterator_9a24c88df860dc65=function(){return u(Symbol.iterator)},e.wbg.__wbg_length_a446193dc22c12f8=function(t){return o(t).length},e.wbg.__wbg_length_e2d2a49132c1b256=function(t){return o(t).length},e.wbg.__wbg_log_cad59bb680daec67=function(t,n,r,_){console.log(o(t),o(n),o(r),o(_))},e.wbg.__wbg_new_405e22f390576ce2=function(){const t=new Object;return u(t)},e.wbg.__wbg_new_78feb108b6472713=function(){const t=new Array;return u(t)},e.wbg.__wbg_new_8a6f238a6ece86ea=function(){const t=new Error;return u(t)},e.wbg.__wbg_new_a12002a7f91c75be=function(t){const n=new Uint8Array(o(t));return u(n)},e.wbg.__wbg_newnoargs_105ed471475aaf50=function(t,n){const r=new Function(p(t,n));return u(r)},e.wbg.__wbg_next_25feadfc0913fea9=function(t){const n=o(t).next;return u(n)},e.wbg.__wbg_next_6574e1a8a62d1055=function(){return W(function(t){const n=o(t).next();return u(n)},arguments)},e.wbg.__wbg_set_37837023f3d740e8=function(t,n,r){o(t)[n>>>0]=d(r)},e.wbg.__wbg_set_3f1d0b984ed272ed=function(t,n,r){o(t)[d(n)]=d(r)},e.wbg.__wbg_set_65595bdd868b3009=function(t,n,r){o(t).set(o(n),r>>>0)},e.wbg.__wbg_stack_0ed75d68575b0f3c=function(t,n){const r=o(n).stack,_=O(r,i.__wbindgen_export_3,i.__wbindgen_export_4),a=h;s().setInt32(t+4*1,a,!0),s().setInt32(t+4*0,_,!0)},e.wbg.__wbg_startWorkers_2ca11761e08ff5d5=function(t,n,r){const _=q(d(t),d(n),L.__wrap(r));return u(_)},e.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const t=typeof global>"u"?null:global;return y(t)?0:u(t)},e.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const t=typeof globalThis>"u"?null:globalThis;return y(t)?0:u(t)},e.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const t=typeof self>"u"?null:self;return y(t)?0:u(t)},e.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const t=typeof window>"u"?null:window;return y(t)?0:u(t)},e.wbg.__wbg_value_cd1ffa7b1ab794f1=function(t){const n=o(t).value;return u(n)},e.wbg.__wbg_warn_aaf1f4664a035bd6=function(t,n,r,_){console.warn(o(t),o(n),o(r),o(_))},e.wbg.__wbindgen_as_number=function(t){return+o(t)},e.wbg.__wbindgen_bigint_from_u64=function(t){const n=BigInt.asUintN(64,t);return u(n)},e.wbg.__wbindgen_bigint_get_as_i64=function(t,n){const r=o(n),_=typeof r=="bigint"?r:void 0;s().setBigInt64(t+8*1,y(_)?BigInt(0):_,!0),s().setInt32(t+4*0,!y(_),!0)},e.wbg.__wbindgen_boolean_get=function(t){const n=o(t);return typeof n=="boolean"?n?1:0:2},e.wbg.__wbindgen_debug_string=function(t,n){const r=S(o(n)),_=O(r,i.__wbindgen_export_3,i.__wbindgen_export_4),a=h;s().setInt32(t+4*1,a,!0),s().setInt32(t+4*0,_,!0)},e.wbg.__wbindgen_error_new=function(t,n){const r=new Error(p(t,n));return u(r)},e.wbg.__wbindgen_in=function(t,n){return o(t)in o(n)},e.wbg.__wbindgen_is_bigint=function(t){return typeof o(t)=="bigint"},e.wbg.__wbindgen_is_function=function(t){return typeof o(t)=="function"},e.wbg.__wbindgen_is_object=function(t){const n=o(t);return typeof n=="object"&&n!==null},e.wbg.__wbindgen_is_undefined=function(t){return o(t)===void 0},e.wbg.__wbindgen_jsval_eq=function(t,n){return o(t)===o(n)},e.wbg.__wbindgen_jsval_loose_eq=function(t,n){return o(t)==o(n)},e.wbg.__wbindgen_memory=function(){const t=i.memory;return u(t)},e.wbg.__wbindgen_module=function(){const t=N.__wbindgen_wasm_module;return u(t)},e.wbg.__wbindgen_number_get=function(t,n){const r=o(n),_=typeof r=="number"?r:void 0;s().setFloat64(t+8*1,y(_)?0:_,!0),s().setInt32(t+4*0,!y(_),!0)},e.wbg.__wbindgen_number_new=function(t){return u(t)},e.wbg.__wbindgen_object_clone_ref=function(t){const n=o(t);return u(n)},e.wbg.__wbindgen_object_drop_ref=function(t){d(t)},e.wbg.__wbindgen_string_get=function(t,n){const r=o(n),_=typeof r=="string"?r:void 0;var a=y(_)?0:O(_,i.__wbindgen_export_3,i.__wbindgen_export_4),c=h;s().setInt32(t+4*1,c,!0),s().setInt32(t+4*0,a,!0)},e.wbg.__wbindgen_string_new=function(t,n){const r=p(t,n);return u(r)},e.wbg.__wbindgen_throw=function(t,n){throw new Error(p(t,n))},e}function z(e,t){e.wbg.memory=t||new WebAssembly.Memory({initial:22,maximum:16384,shared:!0})}function U(e,t,n){if(i=e.exports,N.__wbindgen_wasm_module=t,A=null,k=null,I=null,typeof n<"u"&&(typeof n!="number"||n===0||n%65536!==0))throw"invalid stack size";return i.__wbindgen_start(n),i}function ot(e,t){if(i!==void 0)return i;let n;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module:e,memory:t,thread_stack_size:n}=e:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const r=F();z(r,t),e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const _=new WebAssembly.Instance(e,r);return U(_,e,n)}async function N(e,t){if(i!==void 0)return i;let n;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e,memory:t,thread_stack_size:n}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL("/assets/phomo_wasm_bg-TLpXCakO.wasm",import.meta.url));const r=F();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e)),z(r,t);const{instance:_,module:a}=await X(await e,r);return U(_,a,n)}export{et as ChromaSampling,nt as MetricType,it as Mosaic,rt as ResizeType,_t as Solver,N as default,ot as initSync,Z as initThreadPool,Q as init_panic_hook,Y as overlayGrid,L as wbg_rayon_PoolBuilder,tt as wbg_rayon_start_worker};
